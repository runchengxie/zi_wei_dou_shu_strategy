# 紫微斗数量化交易策略

## 项目简介

本项目将中国传统的紫微斗数命理学说与现代量化交易相结合，创建了一个基于古老智慧的投资决策系统。通过将紫微斗数的星曜四化理论应用于股市交易时机的选择，旨在探索传统哲学与现代金融的创新融合。

## 紫微斗数基础知识

### 什么是紫微斗数？

紫微斗数是中国古代的一种命理学体系，它基于出生时间将星宿排布于十二宫位，通过解读星曜的位置、亮度和相互关系来分析人生命运的各个方面。

### 核心概念

- **天干**: 甲、乙、丙、丁、戊、己、庚、辛、壬、癸，在本系统中用于确定基本星盘结构
- **十二宫位**: 命宫、兄弟宫、夫妻宫、子女宫、财帛宫等，各代表人生不同领域
- **主星**: 紫微星、天机星、太阳星、武曲星等主要星曜
- **四化**: 化禄、化权、化科、化忌，代表不同的能量转化
  - **化禄**: 代表财富、收获
  - **化权**: 代表权力、掌控力
  - **化科**: 代表知识、技术
  - **化忌**: 代表阻碍、挑战

## 量化交易逻辑

### 基本思路

本策略通过以下步骤将紫微斗数与量化交易结合：

1. 根据出生年份确定天干
2. 获取该天干下的星曜四化信息
3. 确定财帛宫主星（负责财富的星曜）
4. 分析该主星在此天干下的"四化"状态
5. 结合日期信息和四化状态生成交易信号

### 评分机制

交易信号基于两部分评分确定：

1. **基础评分**：根据月份和日期计算
   - 特定月份（1,4,7,10月）的偶数日得分+2
   - 特定月份（2,5,8,11月）的3的倍数日得分-2

2. **星曜评分**：根据财帛宫主星的四化状态
   - 化禄: +2分（有利买入）
   - 化权: +1分（小幅有利）
   - 化科: 0分（中性）
   - 化忌: -2分（有利卖出）

3. **决策规则**：
   - 总分 ≥ 2: 买入信号
   - 总分 ≤ -2: 卖出信号
   - 其他: 持有信号

## 代码实现细节

### 主要功能模块

1. **天干确定**
   ```python
   def get_tiangan(year):
       # 通过年份计算对应的天干
   ```

2. **四化规则**
   ```python
   def get_four_transformations(birth_tiangan):
       # 返回特定天干下的星曜四化状态
   ```

3. **财帛宫主星**
   ```python
   def get_finance_star(birth_tiangan):
       # 确定特定天干的财帛宫主星
   ```

4. **信号生成**
   ```python
   def zi_wei_dou_shu_signal(trade_date, finance_star_trans):
       # 结合日期和四化状态生成交易信号
   ```

5. **策略回测**
   ```python
   def predict_buy_sell_zi_wei_stock(birth_year=1990):
       # 主函数，执行回测并可视化结果
   ```

### 使用方法

1. 确保安装了必要的依赖：`pandas`, `matplotlib`, `tushare` 或 `akshare`
2. 如使用tushare，请设置环境变量 `TUSHARE_API_KEY`
3. 运行脚本并指定出生年份：
   ```python
   predict_buy_sell_zi_wei_stock(birth_year=1990)
   ```

### 注意事项

- 本策略为学术研究和娱乐目的，不构成投资建议
- 紫微斗数的完整体系远比本实现复杂，这里仅做简化演示
- 实际交易中应结合更多技术分析和基本面分析
- 不同出生年份产生的交易信号可能有显著差异

## 未来优化方向

1. 引入更完整的紫微斗数体系，包括流年、大限等时间维度
2. 加入更多宫位的综合分析，如事业宫、官禄宫等
3. 引入星曜吉凶度、与其他星曜的相位关系等更复杂因素
4. 结合优化算法，自动调整评分权重以提高策略表现
5. 增加风险管理模块，设置止损止盈条件

## 参考资料

- 《紫微斗数全书》
- 《量化投资策略》
- 《中国古代占星术研究》
